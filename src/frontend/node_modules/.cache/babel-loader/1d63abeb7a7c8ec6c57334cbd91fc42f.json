{"ast":null,"code":"import _slicedToArray from\"/home/bartekj/diet-planner/src/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Formik,Field,Form,ErrorMessage}from\"formik\";import*as Yup from\"yup\";import React,{useState,useEffect}from\"react\";import{Navigate,useNavigate}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import{clearMessage}from\"../slices/message\";import{login}from\"../slices/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useSelector=useSelector(function(state){return state.auth;}),isLoggedIn=_useSelector.isLoggedIn;var _useSelector2=useSelector(function(state){return state.message;}),message=_useSelector2.message;var dispatch=useDispatch();useEffect(function(){dispatch(clearMessage());},[dispatch]);var initialValues={username:\"\",password:\"\"};var validationSchema=Yup.object().shape({username:Yup.string().required(\"This field is required!\"),password:Yup.string().required(\"This field is required!\")});var handleLogin=function handleLogin(formValue){var username=formValue.username,password=formValue.password;setLoading(true);dispatch(login({username:username,password:password})).unwrap().then(function(){navigate(\"/calc\");}).catch(function(){setLoading(false);});};if(isLoggedIn){return/*#__PURE__*/_jsx(Navigate,{to:\"/calc\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Login\"}),/*#__PURE__*/_jsx(Formik,{initialValues:initialValues,validationSchema:validationSchema,onSubmit:handleLogin,children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Field,{name:\"username\",type:\"text\"}),/*#__PURE__*/_jsx(ErrorMessage,{name:\"username\",component:\"div\",className:\"error-msg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password \"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Field,{name:\"password\",type:\"password\"}),/*#__PURE__*/_jsx(ErrorMessage,{name:\"password\",component:\"div\",className:\"error-msg\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",disabled:loading,children:[loading&&/*#__PURE__*/_jsx(\"span\",{children:\"Spinner\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Login\"})]})})]})}),message&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{role:\"alert\",children:message})})]});};export default Login;","map":{"version":3,"names":["Formik","Field","Form","ErrorMessage","Yup","React","useState","useEffect","Navigate","useNavigate","useDispatch","useSelector","clearMessage","login","Login","navigate","loading","setLoading","state","auth","isLoggedIn","message","dispatch","initialValues","username","password","validationSchema","object","shape","string","required","handleLogin","formValue","unwrap","then","catch"],"sources":["/home/bartekj/diet-planner/src/frontend/src/components/Login.js"],"sourcesContent":["import { Formik, Field, Form, ErrorMessage } from \"formik\";\nimport * as Yup from \"yup\";\nimport React, { useState, useEffect } from \"react\";\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {clearMessage} from \"../slices/message\";\nimport {login} from \"../slices/auth\";\n\nconst Login = () => {\n    let navigate = useNavigate();\n    const [loading, setLoading] = useState(false);\n\n    const { isLoggedIn } = useSelector((state => state.auth));\n    const { message } = useSelector((state => state.message));\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        dispatch(clearMessage());\n    }, [dispatch]);\n\n    const initialValues = {\n        username: \"\",\n        password: \"\"\n    };\n\n    const validationSchema = Yup.object().shape({\n        username: Yup.string().required(\"This field is required!\"),\n        password: Yup.string().required(\"This field is required!\"),\n    });\n\n    const handleLogin = (formValue) => {\n        const { username, password } = formValue;\n        setLoading(true);\n\n        dispatch(login({username, password}))\n            .unwrap()\n            .then(() => {\n                navigate(\"/calc\");\n            })\n            .catch(() => {\n                setLoading(false);\n            });\n    };\n\n    if (isLoggedIn) {\n        return <Navigate to=\"/calc\" />;\n    }\n\n    return (\n        <div className=\"container\">\n            <h1>Login</h1>\n        <Formik\n            initialValues={initialValues}\n            validationSchema={validationSchema}\n            onSubmit={handleLogin}\n            >\n            <Form>\n                <div className=\"form-group\">\n                    <label htmlFor=\"username\">Username </label>\n                    <br></br>\n                    <Field name=\"username\" type=\"text\" />\n                    <ErrorMessage name=\"username\" component=\"div\" className=\"error-msg\" />\n                </div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"password\">Password </label>\n                    <br></br>\n                    <Field name=\"password\" type=\"password\" />\n                    <ErrorMessage name=\"password\" component=\"div\" className=\"error-msg\" />\n                </div>\n                <div>\n                    <button type=\"submit\" disabled={loading}>\n                        {loading && (\n                            <span>Spinner</span>\n                        )}\n                        <span>Login</span>\n                    </button>\n                </div>\n            </Form>\n        </Formik>\n            {message && (\n                <div>\n                    <div role=\"alert\">\n                        {message}\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module"}
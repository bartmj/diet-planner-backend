{"ast":null,"code":"import _slicedToArray from \"/home/bartekj/IdeaProjects/diet-planner-backend/src/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/home/bartekj/IdeaProjects/diet-planner-backend/src/frontend/src/components/Login.js\";\nimport { Formik, Field, Form, ErrorMessage } from \"formik\";\nimport * as Yup from \"yup\";\nimport React, { useState, useEffect } from \"react\";\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { clearMessage } from \"../slices/message\";\nimport { login } from \"../slices/auth\";\nvar Login = function Login() {\n  var navigate = useNavigate();\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    loading = _useState2[0],\n    setLoading = _useState2[1];\n  var _useSelector = useSelector(function (state) {\n      return state.auth;\n    }),\n    isLoggedIn = _useSelector.isLoggedIn;\n  var _useSelector2 = useSelector(function (state) {\n      return state.message;\n    }),\n    message = _useSelector2.message;\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(clearMessage());\n  }, [dispatch]);\n  var initialValues = {\n    username: \"\",\n    password: \"\"\n  };\n  var validationSchema = Yup.object().shape({\n    username: Yup.string().required(\"This field is required!\"),\n    password: Yup.string().required(\"This field is required!\")\n  });\n  var handleLogin = function handleLogin(formValue) {\n    var username = formValue.username,\n      password = formValue.password;\n    setLoading(true);\n    dispatch(login({\n      username: username,\n      password: password\n    })).unwrap().then(function () {\n      navigate(\"/calc\");\n    }).catch(function () {\n      setLoading(false);\n    });\n  };\n  if (isLoggedIn) {\n    return /*#__PURE__*/React.createElement(Navigate, {\n      to: \"/calc\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 16\n      }\n    });\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(Formik, {\n    initialValues: initialValues,\n    validationSchema: validationSchema,\n    onSubmit: handleLogin,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"username\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 21\n    }\n  }, \"Username \"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Field, {\n    name: \"username\",\n    type: \"text\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(ErrorMessage, {\n    name: \"username\",\n    component: \"div\",\n    className: \"error-msg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 21\n    }\n  }, \"Password \"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Field, {\n    name: \"password\",\n    type: \"password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(ErrorMessage, {\n    name: \"password\",\n    component: \"div\",\n    className: \"error-msg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    disabled: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  }, loading && /*#__PURE__*/React.createElement(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 29\n    }\n  }, \"Spinner\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 25\n    }\n  }, \"Login\"))))), message && /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    role: \"alert\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 21\n    }\n  }, message)));\n};\nexport default Login;","map":{"version":3,"names":["Formik","Field","Form","ErrorMessage","Yup","React","useState","useEffect","Navigate","useNavigate","useDispatch","useSelector","clearMessage","login","Login","navigate","loading","setLoading","state","auth","isLoggedIn","message","dispatch","initialValues","username","password","validationSchema","object","shape","string","required","handleLogin","formValue","unwrap","then","catch"],"sources":["/home/bartekj/IdeaProjects/diet-planner-backend/src/frontend/src/components/Login.js"],"sourcesContent":["import { Formik, Field, Form, ErrorMessage } from \"formik\";\nimport * as Yup from \"yup\";\nimport React, { useState, useEffect } from \"react\";\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {clearMessage} from \"../slices/message\";\nimport {login} from \"../slices/auth\";\n\nconst Login = () => {\n    let navigate = useNavigate();\n    const [loading, setLoading] = useState(false);\n\n    const { isLoggedIn } = useSelector((state => state.auth));\n    const { message } = useSelector((state => state.message));\n\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        dispatch(clearMessage());\n    }, [dispatch]);\n\n    const initialValues = {\n        username: \"\",\n        password: \"\"\n    };\n\n    const validationSchema = Yup.object().shape({\n        username: Yup.string().required(\"This field is required!\"),\n        password: Yup.string().required(\"This field is required!\"),\n    });\n\n    const handleLogin = (formValue) => {\n        const { username, password } = formValue;\n        setLoading(true);\n\n        dispatch(login({username, password}))\n            .unwrap()\n            .then(() => {\n                navigate(\"/calc\");\n            })\n            .catch(() => {\n                setLoading(false);\n            });\n    };\n\n    if (isLoggedIn) {\n        return <Navigate to=\"/calc\" />;\n    }\n\n    return (\n        <div className=\"container\">\n            <h1>Login</h1>\n        <Formik\n            initialValues={initialValues}\n            validationSchema={validationSchema}\n            onSubmit={handleLogin}\n            >\n            <Form>\n                <div className=\"form-group\">\n                    <label htmlFor=\"username\">Username </label>\n                    <br></br>\n                    <Field name=\"username\" type=\"text\" />\n                    <ErrorMessage name=\"username\" component=\"div\" className=\"error-msg\" />\n                </div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"password\">Password </label>\n                    <br></br>\n                    <Field name=\"password\" type=\"password\" />\n                    <ErrorMessage name=\"password\" component=\"div\" className=\"error-msg\" />\n                </div>\n                <div>\n                    <button type=\"submit\" disabled={loading}>\n                        {loading && (\n                            <span>Spinner</span>\n                        )}\n                        <span>Login</span>\n                    </button>\n                </div>\n            </Form>\n        </Formik>\n            {message && (\n                <div>\n                    <div role=\"alert\">\n                        {message}\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module"}